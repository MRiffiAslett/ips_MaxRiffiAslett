Generating dataset...
Data generation successful. Proceeding with training.
Used config:
{'B': 16,
 'B_seq': 16,
 'D': 128,
 'D_inner': 512,
 'D_k': 16,
 'D_v': 16,
 'H': 8,
 'I': 100,
 'M': 100,
 'N': 1200,
 'attn_dropout': 0.1,
 'data_dir': 'data/megapixel_mnist/dsets/megapixel_mnist_1500',
 'dropout': 0.1,
 'eager': True,
 'enc_type': 'resnet18',
 'eps': 1e-06,
 'is_image': True,
 'lr': 0.001,
 'mask_K': 10,
 'mask_p': 0,
 'n_chan_in': 1,
 'n_class': 10,
 'n_epoch': 100,
 'n_epoch_warmup': 10,
 'n_res_blocks': 2,
 'n_token': 4,
 'n_worker': 4,
 'patch_size': [300, 300],
 'patch_stride': [300, 300],
 'pin_memory': True,
 'pretrained': False,
 'seed': 0,
 'semantic_diversity_loss': False,
 'shuffle': True,
 'shuffle_style': 'batch',
 'tasks': {'task0': {'act_fn': 'softmax',
                     'id': 0,
                     'metric': 'accuracy',
                     'name': 'majority'},
           'task1': {'act_fn': 'softmax',
                     'id': 1,
                     'metric': 'accuracy',
                     'name': 'max'},
           'task2': {'act_fn': 'softmax',
                     'id': 2,
                     'metric': 'accuracy',
                     'name': 'top'},
           'task3': {'act_fn': 'sigmoid',
                     'id': 3,
                     'metric': 'multilabel_accuracy',
                     'name': 'multi'}},
 'track_efficiency': False,
 'track_epoch': 0,
 'use_pos': True,
 'wd': 0.1}
Traceback (most recent call last):
  File "/app/ips_MaxRiffiAslett/main.py", line 71, in <module>
    train_one_epoch(net, criterions, train_loader, optimizer, device, epoch, log_writer_train, conf)
  File "/app/ips_MaxRiffiAslett/training/iterative.py", line 218, in train_one_epoch
    batch_data = fill_batch(mem_patch, mem_pos_enc, labels, data, n_prep, n_prep_batch,
  File "/app/ips_MaxRiffiAslett/training/iterative.py", line 40, in fill_batch
    mem_pos_enc[n_prep:n_prep+n_seq, :len_seq] = mem_pos_enc_iter
RuntimeError: The expanded size of the tensor (100) must match the existing size (1200) at non-singleton dimension 1.  Target sizes: [16, 100, 128].  Tensor sizes: [16, 1200, 128]
