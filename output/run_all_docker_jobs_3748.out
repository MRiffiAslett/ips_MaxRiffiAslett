Generating dataset...
Data generation successful. Proceeding with training.
Used config:
{'B': 16,
 'B_seq': 16,
 'D': 128,
 'D_inner': 512,
 'D_k': 16,
 'D_v': 16,
 'H': 8,
 'I': 100,
 'M': 100,
 'N': 3600,
 'attn_dropout': 0.1,
 'data_dir': 'data/megapixel_mnist/dsets/megapixel_mnist_1500',
 'dropout': 0.1,
 'eager': True,
 'enc_type': 'resnet18',
 'eps': 1e-06,
 'is_image': True,
 'lr': 0.001,
 'mask_K': 10,
 'mask_p': 0,
 'n_chan_in': 1,
 'n_class': 10,
 'n_epoch': 100,
 'n_epoch_warmup': 10,
 'n_res_blocks': 2,
 'n_token': 4,
 'n_worker': 4,
 'patch_size': [50, 50],
 'patch_stride': [50, 50],
 'pin_memory': True,
 'pretrained': False,
 'seed': 0,
 'semantic_diversity_loss': False,
 'shuffle': True,
 'shuffle_style': 'batch',
 'tasks': {'task0': {'act_fn': 'softmax',
                     'id': 0,
                     'metric': 'accuracy',
                     'name': 'majority'},
           'task1': {'act_fn': 'softmax',
                     'id': 1,
                     'metric': 'accuracy',
                     'name': 'max'},
           'task2': {'act_fn': 'softmax',
                     'id': 2,
                     'metric': 'accuracy',
                     'name': 'top'},
           'task3': {'act_fn': 'sigmoid',
                     'id': 3,
                     'metric': 'multilabel_accuracy',
                     'name': 'multi'}},
 'track_efficiency': False,
 'track_epoch': 0,
 'use_pos': True,
 'wd': 0.1}
Train Epoch: 1 
task: majority, mean loss: 2.35071, accuracy: 0.10540, task: max, mean loss: 2.01823, accuracy: 0.24240, task: top, mean loss: 2.34056, accuracy: 0.10080, task: multi, mean loss: 0.64648, multilabel_accuracy: 0.00120, avg. loss over tasks: 1.83900, lr: 0.0001
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

Test Epoch: 1 
task: majority, mean loss: 2.31644, accuracy: 0.09100, task: max, mean loss: 1.87151, accuracy: 0.22100, task: top, mean loss: 2.32810, accuracy: 0.08900, task: multi, mean loss: 0.60172, multilabel_accuracy: 0.00000, avg. loss over tasks: 1.77944
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

Train Epoch: 2 
task: majority, mean loss: 2.27536, accuracy: 0.13080, task: max, mean loss: 1.80947, accuracy: 0.29580, task: top, mean loss: 2.30439, accuracy: 0.11580, task: multi, mean loss: 0.60256, multilabel_accuracy: 0.00000, avg. loss over tasks: 1.74794, lr: 0.0002
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

Test Epoch: 2 
task: majority, mean loss: 2.75018, accuracy: 0.10000, task: max, mean loss: 2.16840, accuracy: 0.21300, task: top, mean loss: 2.43669, accuracy: 0.10000, task: multi, mean loss: 0.63868, multilabel_accuracy: 0.00200, avg. loss over tasks: 1.99849
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

Train Epoch: 3 
task: majority, mean loss: 2.01488, accuracy: 0.25400, task: max, mean loss: 1.64952, accuracy: 0.38380, task: top, mean loss: 2.16070, accuracy: 0.20300, task: multi, mean loss: 0.57984, multilabel_accuracy: 0.00260, avg. loss over tasks: 1.60123, lr: 0.00030000000000000003
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

Test Epoch: 3 
task: majority, mean loss: 2.89501, accuracy: 0.13900, task: max, mean loss: 1.80819, accuracy: 0.36800, task: top, mean loss: 2.63918, accuracy: 0.15200, task: multi, mean loss: 0.61275, multilabel_accuracy: 0.00200, avg. loss over tasks: 1.98878
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

Train Epoch: 4 
task: majority, mean loss: 1.57698, accuracy: 0.42620, task: max, mean loss: 1.40920, accuracy: 0.47660, task: top, mean loss: 1.89200, accuracy: 0.34940, task: multi, mean loss: 0.53339, multilabel_accuracy: 0.00720, avg. loss over tasks: 1.35289, lr: 0.0004
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

Test Epoch: 4 
task: majority, mean loss: 3.02671, accuracy: 0.13800, task: max, mean loss: 1.85599, accuracy: 0.30200, task: top, mean loss: 2.50116, accuracy: 0.22400, task: multi, mean loss: 0.63169, multilabel_accuracy: 0.00500, avg. loss over tasks: 2.00389
Diversity Loss - Mean: 0.00000, Variance: 0.00000
Semantic Loss - Mean: 0.00000, Variance: 0.00000

