Generating dataset...
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
    8192/11490434 [..............................] - ETA: 0s   32768/11490434 [..............................] - ETA: 24s   49152/11490434 [..............................] - ETA: 28s   81920/11490434 [..............................] - ETA: 29s  147456/11490434 [..............................] - ETA: 20s  221184/11490434 [..............................] - ETA: 15s  319488/11490434 [..............................] - ETA: 12s  499712/11490434 [>.............................] - ETA: 9s   745472/11490434 [>.............................] - ETA: 6s  966656/11490434 [=>............................] - ETA: 5s 1196032/11490434 [==>...........................] - ETA: 4s 1359872/11490434 [==>...........................] - ETA: 4s 1523712/11490434 [==>...........................] - ETA: 4s 1736704/11490434 [===>..........................] - ETA: 4s 2269184/11490434 [====>.........................] - ETA: 3s 2547712/11490434 [=====>........................] - ETA: 2s 2826240/11490434 [======>.......................] - ETA: 2s 3366912/11490434 [=======>......................] - ETA: 2s 4456448/11490434 [==========>...................] - ETA: 1s 5275648/11490434 [============>.................] - ETA: 1s 6619136/11490434 [================>.............] - ETA: 0s 7266304/11490434 [=================>............] - ETA: 0s 8011776/11490434 [===================>..........] - ETA: 0s 9191424/11490434 [======================>.......] - ETA: 0s10272768/11490434 [=========================>....] - ETA: 0s11157504/11490434 [============================>.] - ETA: 0s11490434/11490434 [==============================] - 1s 0us/step
Data generation successful. Proceeding with training.
Used config:
{'B': 16,
 'B_seq': 16,
 'D': 128,
 'D_inner': 512,
 'D_k': 16,
 'D_v': 16,
 'H': 8,
 'I': 18,
 'M': 18,
 'N': 100,
 'attn_dropout': 0.1,
 'data_dir': 'data/megapixel_mnist/dsets/megapixel_mnist_1500',
 'dropout': 0.1,
 'eager': True,
 'enc_type': 'resnet18',
 'eps': 1e-06,
 'is_image': True,
 'lr': 0.001,
 'mask_K': 10,
 'mask_p': 0,
 'n_chan_in': 1,
 'n_class': 10,
 'n_epoch': 100,
 'n_epoch_warmup': 10,
 'n_res_blocks': 2,
 'n_token': 4,
 'n_worker': 2,
 'patch_size': [300, 300],
 'patch_stride': [300, 300],
 'pin_memory': True,
 'pretrained': False,
 'seed': 0,
 'semantic_diversity_loss': False,
 'shuffle': True,
 'shuffle_style': 'batch',
 'tasks': {'task0': {'act_fn': 'softmax',
                     'id': 0,
                     'metric': 'accuracy',
                     'name': 'majority'},
           'task1': {'act_fn': 'softmax',
                     'id': 1,
                     'metric': 'accuracy',
                     'name': 'max'},
           'task2': {'act_fn': 'softmax',
                     'id': 2,
                     'metric': 'accuracy',
                     'name': 'top'},
           'task3': {'act_fn': 'sigmoid',
                     'id': 3,
                     'metric': 'multilabel_accuracy',
                     'name': 'multi'}},
 'track_efficiency': False,
 'track_epoch': 0,
 'use_pos': True,
 'wd': 0.1}
