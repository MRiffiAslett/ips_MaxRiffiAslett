Generating dataset...
Data generation successful. Proceeding with training.
Used config:
{'B': 16,
 'B_seq': 16,
 'D': 128,
 'D_inner': 512,
 'D_k': 16,
 'D_v': 16,
 'H': 8,
 'I': 100,
 'M': 100,
 'N': 3600,
 'attn_dropout': 0.1,
 'data_dir': 'data/megapixel_mnist/dsets/megapixel_mnist_1500',
 'dropout': 0.1,
 'eager': True,
 'enc_type': 'resnet18',
 'eps': 1e-06,
 'is_image': True,
 'lr': 0.001,
 'mask_K': 10,
 'mask_p': 0,
 'n_chan_in': 1,
 'n_class': 10,
 'n_epoch': 100,
 'n_epoch_warmup': 10,
 'n_res_blocks': 2,
 'n_token': 4,
 'n_worker': 4,
 'patch_size': [50, 50],
 'patch_stride': [50, 50],
 'pin_memory': True,
 'pretrained': False,
 'seed': 0,
 'semantic_diversity_loss': True,
 'shuffle': True,
 'shuffle_style': 'batch',
 'tasks': {'task0': {'act_fn': 'softmax',
                     'id': 0,
                     'metric': 'accuracy',
                     'name': 'majority'},
           'task1': {'act_fn': 'softmax',
                     'id': 1,
                     'metric': 'accuracy',
                     'name': 'max'},
           'task2': {'act_fn': 'softmax',
                     'id': 2,
                     'metric': 'accuracy',
                     'name': 'top'},
           'task3': {'act_fn': 'sigmoid',
                     'id': 3,
                     'metric': 'multilabel_accuracy',
                     'name': 'multi'}},
 'track_efficiency': False,
 'track_epoch': 0,
 'use_pos': True,
 'wd': 0.1}
Train Epoch: 1 
task: majority, mean loss: 2.35221, accuracy: 0.10380, task: max, mean loss: 2.02505, accuracy: 0.24380, task: top, mean loss: 2.33988, accuracy: 0.09900, task: multi, mean loss: 0.64806, multilabel_accuracy: 0.00120, avg. loss over tasks: 1.84130, lr: 0.0001
Diversity Loss - Mean: -0.12533, Variance: 0.09529
Semantic Loss - Mean: 1.89832, Variance: 0.00367

Test Epoch: 1 
task: majority, mean loss: 2.31574, accuracy: 0.08900, task: max, mean loss: 1.87354, accuracy: 0.21300, task: top, mean loss: 2.33114, accuracy: 0.08900, task: multi, mean loss: 0.60274, multilabel_accuracy: 0.00000, avg. loss over tasks: 1.78079
Diversity Loss - Mean: -0.14116, Variance: 0.15171
Semantic Loss - Mean: 1.78635, Variance: 0.00017

Train Epoch: 2 
task: majority, mean loss: 2.31236, accuracy: 0.10820, task: max, mean loss: 1.82777, accuracy: 0.27020, task: top, mean loss: 2.32098, accuracy: 0.10480, task: multi, mean loss: 0.60479, multilabel_accuracy: 0.00000, avg. loss over tasks: 1.76648, lr: 0.0002
Diversity Loss - Mean: -0.14096, Variance: 0.13141
Semantic Loss - Mean: 1.76694, Variance: 0.00192

Test Epoch: 2 
task: majority, mean loss: 2.29671, accuracy: 0.18000, task: max, mean loss: 1.86054, accuracy: 0.27400, task: top, mean loss: 2.32014, accuracy: 0.11900, task: multi, mean loss: 0.60220, multilabel_accuracy: 0.00000, avg. loss over tasks: 1.76990
Diversity Loss - Mean: -0.13096, Variance: 0.14841
Semantic Loss - Mean: 1.77266, Variance: 0.00014

Train Epoch: 3 
task: majority, mean loss: 1.94651, accuracy: 0.27460, task: max, mean loss: 1.70123, accuracy: 0.35400, task: top, mean loss: 2.14610, accuracy: 0.21220, task: multi, mean loss: 0.58307, multilabel_accuracy: 0.00420, avg. loss over tasks: 1.59423, lr: 0.00030000000000000003
Diversity Loss - Mean: -0.12324, Variance: 0.12626
Semantic Loss - Mean: 1.68978, Variance: 0.00183

Test Epoch: 3 
task: majority, mean loss: 2.39612, accuracy: 0.21700, task: max, mean loss: 2.22881, accuracy: 0.28000, task: top, mean loss: 2.38927, accuracy: 0.16000, task: multi, mean loss: 0.60382, multilabel_accuracy: 0.00900, avg. loss over tasks: 1.90450
Diversity Loss - Mean: -0.10394, Variance: 0.12873
Semantic Loss - Mean: 1.79088, Variance: 0.00093

Train Epoch: 4 
task: majority, mean loss: 1.52958, accuracy: 0.41540, task: max, mean loss: 1.41586, accuracy: 0.47560, task: top, mean loss: 1.87011, accuracy: 0.33460, task: multi, mean loss: 0.53710, multilabel_accuracy: 0.01320, avg. loss over tasks: 1.33816, lr: 0.0004
Diversity Loss - Mean: -0.11163, Variance: 0.11778
Semantic Loss - Mean: 1.45531, Variance: 0.00214

Test Epoch: 4 
task: majority, mean loss: 1.41027, accuracy: 0.47400, task: max, mean loss: 1.32503, accuracy: 0.54800, task: top, mean loss: 2.06341, accuracy: 0.32500, task: multi, mean loss: 0.52594, multilabel_accuracy: 0.01700, avg. loss over tasks: 1.33116
Diversity Loss - Mean: -0.09466, Variance: 0.11265
Semantic Loss - Mean: 1.39233, Variance: 0.00121

Train Epoch: 5 
task: majority, mean loss: 1.21668, accuracy: 0.54220, task: max, mean loss: 1.04794, accuracy: 0.64340, task: top, mean loss: 1.53463, accuracy: 0.47180, task: multi, mean loss: 0.49266, multilabel_accuracy: 0.02420, avg. loss over tasks: 1.07298, lr: 0.0005
Diversity Loss - Mean: -0.10681, Variance: 0.11196
Semantic Loss - Mean: 1.24093, Variance: 0.00263

Test Epoch: 5 
task: majority, mean loss: 1.13284, accuracy: 0.57400, task: max, mean loss: 0.84939, accuracy: 0.70400, task: top, mean loss: 1.37662, accuracy: 0.51400, task: multi, mean loss: 0.45820, multilabel_accuracy: 0.02200, avg. loss over tasks: 0.95426
Diversity Loss - Mean: -0.10840, Variance: 0.10903
Semantic Loss - Mean: 1.06467, Variance: 0.00143

Train Epoch: 6 
task: majority, mean loss: 0.89560, accuracy: 0.66960, task: max, mean loss: 0.88125, accuracy: 0.70760, task: top, mean loss: 1.21763, accuracy: 0.60260, task: multi, mean loss: 0.45280, multilabel_accuracy: 0.04280, avg. loss over tasks: 0.86182, lr: 0.0006000000000000001
Diversity Loss - Mean: -0.10413, Variance: 0.10778
Semantic Loss - Mean: 1.03333, Variance: 0.00305

Test Epoch: 6 
task: majority, mean loss: 1.55505, accuracy: 0.46200, task: max, mean loss: 1.39880, accuracy: 0.51800, task: top, mean loss: 1.47181, accuracy: 0.49000, task: multi, mean loss: 0.49920, multilabel_accuracy: 0.04900, avg. loss over tasks: 1.23122
Diversity Loss - Mean: -0.11832, Variance: 0.11276
Semantic Loss - Mean: 1.23869, Variance: 0.00179

Train Epoch: 7 
task: majority, mean loss: 0.70632, accuracy: 0.74720, task: max, mean loss: 0.76138, accuracy: 0.74500, task: top, mean loss: 0.97099, accuracy: 0.69400, task: multi, mean loss: 0.42289, multilabel_accuracy: 0.07160, avg. loss over tasks: 0.71540, lr: 0.0007
Diversity Loss - Mean: -0.10499, Variance: 0.10539
Semantic Loss - Mean: 0.88608, Variance: 0.00347

Test Epoch: 7 
task: majority, mean loss: 0.71489, accuracy: 0.72500, task: max, mean loss: 0.83045, accuracy: 0.69900, task: top, mean loss: 0.88425, accuracy: 0.70200, task: multi, mean loss: 0.41463, multilabel_accuracy: 0.08900, avg. loss over tasks: 0.71105
Diversity Loss - Mean: -0.10269, Variance: 0.11092
Semantic Loss - Mean: 0.80473, Variance: 0.00172

Train Epoch: 8 
task: majority, mean loss: 0.55187, accuracy: 0.80680, task: max, mean loss: 0.68487, accuracy: 0.77420, task: top, mean loss: 0.83639, accuracy: 0.73500, task: multi, mean loss: 0.39689, multilabel_accuracy: 0.09520, avg. loss over tasks: 0.61750, lr: 0.0008
Diversity Loss - Mean: -0.10477, Variance: 0.10398
Semantic Loss - Mean: 0.79429, Variance: 0.00381

Test Epoch: 8 
task: majority, mean loss: 0.76080, accuracy: 0.74400, task: max, mean loss: 0.85437, accuracy: 0.70700, task: top, mean loss: 0.93954, accuracy: 0.71700, task: multi, mean loss: 0.41307, multilabel_accuracy: 0.10600, avg. loss over tasks: 0.74195
Diversity Loss - Mean: -0.11068, Variance: 0.11139
Semantic Loss - Mean: 0.81235, Variance: 0.00169

Train Epoch: 9 
task: majority, mean loss: 0.50442, accuracy: 0.82200, task: max, mean loss: 0.61775, accuracy: 0.79960, task: top, mean loss: 0.68863, accuracy: 0.78380, task: multi, mean loss: 0.35990, multilabel_accuracy: 0.12780, avg. loss over tasks: 0.54267, lr: 0.0009000000000000001
Diversity Loss - Mean: -0.10655, Variance: 0.10329
Semantic Loss - Mean: 0.72938, Variance: 0.00411

Test Epoch: 9 
task: majority, mean loss: 1.27989, accuracy: 0.56200, task: max, mean loss: 0.87001, accuracy: 0.71200, task: top, mean loss: 0.94523, accuracy: 0.72300, task: multi, mean loss: 0.40895, multilabel_accuracy: 0.09200, avg. loss over tasks: 0.87602
Diversity Loss - Mean: -0.11528, Variance: 0.11354
Semantic Loss - Mean: 0.94192, Variance: 0.00200

