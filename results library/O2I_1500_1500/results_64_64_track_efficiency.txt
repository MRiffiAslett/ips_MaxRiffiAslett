Used config:
{'B': 16,
 'B_seq': 16,
 'D': 128,
 'D_inner': 512,
 'D_k': 16,
 'D_v': 16,
 'H': 8,
 'I': 100,
 'M': 100,
 'N': 900,
 'attn_dropout': 0.1,
 'data_dir': 'data/megapixel_mnist/dsets/megapixel_mnist_1500',
 'dropout': 0.1,
 'eager': True,
 'enc_type': 'resnet18',
 'eps': 1e-06,
 'is_image': True,
 'lr': 0.001,
 'n_chan_in': 1,
 'n_class': 10,
 'n_epoch': 150,
 'n_epoch_warmup': 10,
 'n_res_blocks': 2,
 'n_token': 4,
 'n_worker': 8,
 'patch_size': [50, 50],
 'patch_stride': [50, 50],
 'pin_memory': True,
 'pretrained': False,
 'seed': 0,
 'shuffle': True,
 'shuffle_style': 'batch',
 'tasks': {'task0': {'act_fn': 'softmax',
                     'id': 0,
                     'metric': 'accuracy',
                     'name': 'majority'},
           'task1': {'act_fn': 'softmax',
                     'id': 1,
                     'metric': 'accuracy',
                     'name': 'max'},
           'task2': {'act_fn': 'softmax',
                     'id': 2,
                     'metric': 'accuracy',
                     'name': 'top'},
           'task3': {'act_fn': 'sigmoid',
                     'id': 3,
                     'metric': 'multilabel_accuracy',
                     'name': 'multi'}},
 'track_efficiency': True,
 'track_epoch': 0,
 'use_pos': True,
 'wd': 0.1}
time:  658.8729248046875
time:  657.5595703125
time:  656.7465209960938
time:  659.4212036132812
time:  657.7816772460938
time:  657.7720947265625
time:  659.2769165039062
time:  658.0269165039062
time:  657.2066040039062
time:  659.1702270507812
time:  659.1909790039062
time:  657.620849609375
time:  659.2572021484375
time:  657.768310546875
time:  657.5881958007812
time:  659.1341552734375
time:  658.0490112304688
time:  660.1177368164062
time:  657.9274291992188
time:  657.4860229492188
time:  658.5586547851562
time:  658.4122314453125
time:  659.604248046875
time:  658.32958984375
time:  660.4649047851562
time:  658.1900634765625
time:  658.91064453125
time:  659.490966796875
time:  658.2380981445312
time:  659.4778442382812
time:  658.8113403320312
time:  659.511962890625
time:  659.2528076171875
time:  658.6970825195312
time:  660.5108642578125
time:  659.0873413085938
time:  660.2137451171875
time:  658.4151611328125
time:  659.8512573242188
time:  659.618408203125
time:  660.6130981445312
time:  658.674560546875
time:  660.3973999023438
time:  659.94140625
time:  660.937255859375
time:  658.9884033203125
time:  659.98974609375
time:  659.2484130859375
time:  657.8540649414062
time:  660.6795654296875
time:  658.8805541992188
time:  661.631103515625
time:  659.643310546875
time:  660.1809692382812
time:  659.2433471679688
time:  658.3492431640625
time:  660.836669921875
time:  659.8817749023438
time:  660.0458374023438
time:  658.9767456054688
time:  661.8541870117188
time:  661.0958251953125
time:  660.959716796875
time:  661.8035888671875
time:  660.8261108398438
time:  661.7171020507812
time:  659.6438598632812
time:  661.6757202148438
time:  660.6909790039062
time:  661.5203857421875
time:  660.6336059570312
time:  661.7108764648438
time:  660.1766357421875
time:  660.832275390625
time:  660.2568359375
time:  660.7192993164062
time:  662.6099243164062
time:  661.1824340820312
time:  661.7763671875
time:  661.0267944335938
time:  663.6746826171875
time:  662.0631103515625
time:  661.8008422851562
time:  663.195556640625
time:  660.5979614257812
time:  662.5914916992188
time:  661.64697265625
time:  662.6307373046875
time:  661.3003540039062
time:  661.8465576171875
time:  661.2698974609375
time:  661.9600830078125
time:  660.5181884765625
time:  661.97265625
time:  660.8553466796875
time:  662.9590454101562
time:  661.4171142578125
time:  663.8077392578125
time:  663.9874877929688
time:  663.148193359375
time:  662.7518920898438
time:  662.0387573242188
time:  662.540283203125
time:  662.7224731445312
time:  663.046142578125
time:  662.8472900390625
time:  663.745361328125
time:  661.5162963867188
time:  662.5897827148438
time:  662.0795288085938
time:  663.0748291015625
time:  664.6722412109375
time:  661.5326538085938
time:  663.2243041992188
time:  662.4712524414062
time:  663.6398315429688
time:  663.4434814453125
time:  662.0244140625
time:  664.282470703125
time:  662.9370727539062
time:  664.9204711914062
time:  664.451416015625
time:  662.581787109375
time:  664.2197265625
time:  664.1035766601562
time:  662.2330932617188
time:  663.7959594726562
time:  664.8541259765625
time:  663.9247436523438
time:  663.0350952148438
time:  664.1080932617188
time:  664.3218994140625
time:  663.4338989257812
time:  663.6858520507812
time:  665.2922973632812
time:  663.5753173828125
time:  665.0831909179688
time:  666.0465087890625
time:  664.0988159179688
time:  663.8673706054688
time:  664.7493896484375
time:  665.2590942382812
time:  663.961669921875
time:  663.7670288085938
time:  665.10009765625
time:  664.2195434570312
time:  664.0567626953125
time:  664.9183959960938
time:  665.6304931640625
time:  664.2993774414062
time:  664.7296142578125
time:  664.7404174804688
time:  665.0115966796875
time:  665.1043701171875
time:  665.1146240234375
time:  666.74755859375
time:  665.700927734375
time:  665.4508056640625
time:  665.2425537109375
time:  665.6532592773438
time:  668.0411987304688
time:  664.889892578125
time:  665.427978515625
time:  667.2781372070312
time:  666.87890625
time:  665.554931640625
time:  665.6864624023438
time:  665.5979614257812
time:  668.3283081054688
time:  667.6681518554688
time:  666.51123046875
time:  666.134521484375
time:  666.6757202148438
time:  666.5590209960938
time:  669.9008178710938
time:  670.1929321289062
time:  668.514892578125
time:  667.6725463867188
time:  667.719482421875
time:  666.70166015625
time:  666.9285888671875
time:  667.53076171875
time:  667.0401000976562
time:  669.5662231445312
time:  669.2858276367188
time:  668.4827880859375
time:  668.1146240234375
time:  666.349365234375
time:  668.30859375
time:  667.8466796875
time:  668.4319458007812
time:  666.9271240234375
time:  667.1549072265625
time:  667.3128051757812
time:  667.9696655273438
time:  667.9695434570312
time:  668.787109375
time:  666.308837890625
time:  666.1529541015625
time:  668.3132934570312
time:  666.787841796875
time:  667.855224609375
time:  666.5394287109375
time:  667.81591796875
time:  666.7341918945312
time:  668.4157104492188
time:  668.133056640625
time:  667.0579223632812
time:  666.9291381835938
time:  665.8989868164062
time:  668.9572143554688
time:  668.50048828125
time:  666.5154418945312
time:  667.662353515625
time:  667.166748046875
time:  668.626953125
time:  669.2936401367188
time:  668.205322265625
time:  667.7936401367188
time:  665.2504272460938
time:  667.8008422851562
time:  666.869140625
time:  666.798095703125
time:  668.5593872070312
time:  666.8544921875
time:  666.429443359375
time:  666.9012451171875
time:  667.1605224609375
time:  669.2003784179688
time:  669.00732421875
time:  668.0250244140625
time:  667.9779663085938
time:  666.9298706054688
time:  667.3468627929688
time:  667.4125366210938
time:  667.3099365234375
time:  668.0159912109375
time:  667.5086669921875
time:  666.5621948242188
time:  667.7913818359375
time:  667.6746826171875
time:  668.0862426757812
time:  667.6341552734375
time:  667.0909423828125
time:  666.5748291015625
time:  667.6889038085938
time:  668.2622680664062
time:  668.373779296875
time:  668.030517578125
time:  669.8721313476562
time:  668.5859985351562
time:  669.0713500976562
time:  668.6760864257812
time:  668.0186767578125
time:  667.3844604492188
time:  667.1893310546875
time:  668.1658325195312
time:  669.1375732421875
time:  668.3602294921875
time:  668.4342041015625
time:  668.7644653320312
time:  670.3104248046875
time:  669.0185546875
time:  669.8601684570312
time:  669.9114379882812
time:  670.558349609375
time:  669.1266479492188
time:  670.0198974609375
time:  670.1158447265625
time:  669.8013916015625
time:  669.3134765625
time:  669.2332763671875
time:  667.8280639648438
time:  668.5819091796875
time:  669.8133544921875
time:  669.6453857421875
time:  669.4993896484375
time:  669.83935546875
time:  668.8549194335938
time:  669.9929809570312
time:  668.9821166992188
time:  670.593505859375
time:  669.7000732421875
time:  671.759521484375
time:  670.0254516601562
time:  671.320068359375
time:  669.934814453125
time:  669.6530151367188
time:  669.8350830078125
time:  672.239501953125
time:  670.1583251953125
time:  671.09423828125
time:  671.0258178710938
time:  671.088623046875
time:  671.7941284179688
time:  672.0797119140625
time:  671.8013305664062
time:  671.5532836914062
time:  670.6323852539062
time:  671.818359375
time:  670.6124267578125
time:  670.6030883789062
time:  670.5071411132812
time:  671.5637817382812
time:  671.3118896484375
time:  670.9452514648438
time:  670.7660522460938
time:  670.349365234375
time:  668.993408203125
time:  669.349853515625
time:  670.9259033203125
avg. time:  664.924692626168
Peak memory requirement: 1.9762 GB
TORCH.CUDA.MEMORY_SUMMARY:  |===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 126577 KiB |   2023 MiB |  14801 GiB |  14801 GiB |
|       from large pool | 111137 KiB |   2010 MiB |  14786 GiB |  14786 GiB |
|       from small pool |  15440 KiB |     21 MiB |     14 GiB |     14 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 126577 KiB |   2023 MiB |  14801 GiB |  14801 GiB |
|       from large pool | 111137 KiB |   2010 MiB |  14786 GiB |  14786 GiB |
|       from small pool |  15440 KiB |     21 MiB |     14 GiB |     14 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 125802 KiB |   2022 MiB |  14799 GiB |  14799 GiB |
|       from large pool | 110390 KiB |   2008 MiB |  14784 GiB |  14784 GiB |
|       from small pool |  15412 KiB |     21 MiB |     14 GiB |     14 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2200 MiB |   2200 MiB |   2200 MiB |      0 B   |
|       from large pool |   2176 MiB |   2176 MiB |   2176 MiB |      0 B   |
|       from small pool |     24 MiB |     24 MiB |     24 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 768398 KiB |    900 MiB |   5969 GiB |   5968 GiB |
|       from large pool | 765406 KiB |    896 MiB |   5953 GiB |   5952 GiB |
|       from small pool |   2992 KiB |      7 MiB |     15 GiB |     15 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     247    |     298    |  240257    |  240010    |
|       from large pool |       5    |      28    |  121406    |  121401    |
|       from small pool |     242    |     293    |  118851    |  118609    |
|---------------------------------------------------------------------------|
| Active allocs         |     247    |     298    |  240257    |  240010    |
|       from large pool |       5    |      28    |  121406    |  121401    |
|       from small pool |     242    |     293    |  118851    |  118609    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      22    |      22    |       0    |
|       from large pool |      10    |      10    |      10    |       0    |
|       from small pool |      12    |      12    |      12    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |      29    |  126468    |  126444    |
|       from large pool |       5    |      10    |   79544    |   79539    |
|       from small pool |      19    |      24    |   46924    |   46905    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

